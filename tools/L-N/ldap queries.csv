"keyword","metadata_keyword_regex","metadata_keyword_type","metadata_tool","metadata_description","metadata_tool_techniques","metadata_tool_tactics","metadata_malwares_name","metadata_groups_name","metadata_category","metadata_link","metadata_enable_endpoint_detection","metadata_enable_proxy_detection","metadata_tags","metadata_comment","metadata_severity_score","metadata_popularity_score","metadata_github_stars","metadata_github_forks","metadata_github_updated_at","metadata_github_created_at","metadata_entry_id"
"*(&(&(objectCategory=person)(objectClass=user))(|(description=*pass*)(comment=*pass*)))*",".{0,1000}\(\&\(\&\(objectCategory\=person\)\(objectClass\=user\)\)\(\|\(description\=.{0,1000}pass.{0,1000}\)\(comment\=.{0,1000}pass.{0,1000}\)\)\).{0,1000}","greyware_tool_keyword","ldap queries","metasploit enum_ad_user_comments","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/hunting-for-reconnaissance-activities-using-ldap-search-filters/ba-p/824726","1","0","N/A","N/A","8","4","N/A","N/A","N/A","N/A","4053"
"*(&(objectCategory=computer)(msDS-isRODC=TRUE))*",".{0,1000}\(\&\(objectCategory\=computer\)\(msDS\-isRODC\=TRUE\)\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate Read-Only Domain Controllers (RODC)","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/mthcht/ThreatHunting-Keywords","1","0","N/A","N/A","8","6","563","61","2025-03-03T15:48:41Z","2023-05-16T15:38:26Z","4057"
"*(&(objectCategory=computer)(ms-MCS-AdmPwd=*)(sAMAccountName="" + target + ""))*",".{0,1000}\(\&\(objectCategory\=computer\)\(ms\-MCS\-AdmPwd\=.{0,1000}\)\(sAMAccountName\=\""\s\+\starget\s\+\s\""\)\).{0,1000}","greyware_tool_keyword","ldap queries","LAPS passwords (from SharpLAPS)","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4058"
"*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)(memberOf=CN=Administrators*",".{0,1000}\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=65536\)\(memberOf\=CN\=Administrators.{0,1000}","greyware_tool_keyword","ldap queries","Enumerate Accounts with Non-Expiring Passwords and Administrative Privileges","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/mthcht/ThreatHunting-Keywords","1","0","N/A","N/A","8","6","563","61","2025-03-03T15:48:41Z","2023-05-16T15:38:26Z","4059"
"*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)*",".{0,1000}\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=65536\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all users with the account configuration 'Password never expires'","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4060"
"*(&(objectClass=group)(managedBy=*)(groupType:1.2.840.113556.1.4.803:=2147483648))*",".{0,1000}\(\&\(objectClass\=group\)\(managedBy\=.{0,1000}\)\(groupType\:1\.2\.840\.113556\.1\.4\.803\:\=2147483648\)\).{0,1000}","greyware_tool_keyword","ldap queries","metasploit  enum_ad_managedby_groups.rb","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/rapid7/metasploit-framework/blob/d37a82500d1d08f9d8ab3da9b194653835748fae/modules/post/windows/gather/enum_ad_managedby_groups.rb#L59","1","0","N/A","N/A","8","10","35400","14272","2025-04-22T20:14:59Z","2011-08-30T06:13:20Z","4061"
"*(&(objectclass=group)(samaccountname=*domain admins*))*",".{0,1000}\(\&\(objectclass\=group\)\(samaccountname\=.{0,1000}domain\sadmins.{0,1000}\)\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate Domain Administrators Group","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4062"
"*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2))(!msds-supportedencryptiontypes:1.2.840.113556.1.4.804:=24))*",".{0,1000}\(\&\(samAccountType\=805306368\)\(servicePrincipalName\=.{0,1000}\)\(!samAccountName\=krbtgt\)\(!\(UserAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\(!msds\-supportedencryptiontypes\:1\.2\.840\.113556\.1\.4\.804\:\=24\)\).{0,1000}","greyware_tool_keyword","ldap queries","Kerberoasting","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4063"
"*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2))(msds-supportedencryptiontypes:1.2.840.113556.1.4.804:=24))*",".{0,1000}\(\&\(samAccountType\=805306368\)\(servicePrincipalName\=.{0,1000}\)\(!samAccountName\=krbtgt\)\(!\(UserAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\(msds\-supportedencryptiontypes\:1\.2\.840\.113556\.1\.4\.804\:\=24\)\).{0,1000}","greyware_tool_keyword","ldap queries","Kerberoasting","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4064"
"*(&(samAccountType=805306368)(servicePrincipalName=*)(!samAccountName=krbtgt)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))*",".{0,1000}\(\&\(samAccountType\=805306368\)\(servicePrincipalName\=.{0,1000}\)\(!samAccountName\=krbtgt\)\(!\(UserAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\).{0,1000}","greyware_tool_keyword","ldap queries","Kerberoasting","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4065"
"*([adsisearcher]'(&(objectCategory=computer)(!(primaryGroupID=516)(userAccountControl:1.2.840.113556.1.4.803:=524288)))').FindAll()*",".{0,1000}\(\[adsisearcher\]\'\(\&\(objectCategory\=computer\)\(!\(primaryGroupID\=516\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=524288\)\)\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all servers configured for Unconstrained Delegation","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","N/A","1","0","N/A","N/A","9","10","N/A","N/A","N/A","N/A","4067"
"*([adsisearcher]'(&(objectCategory=computer)(userAccountControl:1.2.840.113556.1.4.803:=8192))').FindAll()*",".{0,1000}\(\[adsisearcher\]\'\(\&\(objectCategory\=computer\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=8192\)\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all Domain Controllers","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://web.archive.org/web/20240109000256/https://cyberdom.blog/2024/01/07/defender-for-identity-hunting-for-ldap/","1","0","N/A","N/A","9","10","N/A","N/A","N/A","N/A","4068"
"*([adsisearcher]'(&(objectCategory=user)(!(samAccountName=krbtgt)(servicePrincipalName=*)))').FindAll()*",".{0,1000}\(\[adsisearcher\]\'\(\&\(objectCategory\=user\)\(!\(samAccountName\=krbtgt\)\(servicePrincipalName\=.{0,1000}\)\)\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Search for user accounts with SPN but not TGT accounts","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4069"
"*([adsisearcher]'(adminCount=1)').FindAll()*",".{0,1000}\(\[adsisearcher\]\'\(adminCount\=1\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Search for all objects with AdminSHHolder","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4070"
"*([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Domains*",".{0,1000}\(\[DirectoryServices\.ActiveDirectory\.Forest\]\:\:GetCurrentForest\(\)\)\.Domains.{0,1000}","greyware_tool_keyword","ldap queries","Queries for domain level and mode information","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","4071"
"*([DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()).Sites | *",".{0,1000}\(\[DirectoryServices\.ActiveDirectory\.Forest\]\:\:GetCurrentForest\(\)\)\.Sites\s\|\s.{0,1000}","greyware_tool_keyword","ldap queries","enumeration of AD Forest Sites","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","4072"
"*([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).FindAllDomainControllers() | Select-Object -Property *",".{0,1000}\(\[System\.DirectoryServices\.ActiveDirectory\.Domain\]\:\:GetCurrentDomain\(\)\)\.FindAllDomainControllers\(\)\s\|\sSelect\-Object\s\-Property\s.{0,1000}","greyware_tool_keyword","ldap queries","querying all domain controllers with detailed properties","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","4073"
"*([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()*",".{0,1000}\(\[System\.DirectoryServices\.ActiveDirectory\.Domain\]\:\:GetCurrentDomain\(\)\)\.GetAllTrustRelationships\(\).{0,1000}","greyware_tool_keyword","ldap queries","get all trust relationships in the current domain","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","4074"
"*(Get-ADForest).Domains | %{ Get-ADDomainController -Filter * -Server $_ }*",".{0,1000}\(Get\-ADForest\)\.Domains\s\|\s\%\{\sGet\-ADDomainController\s\-Filter\s.{0,1000}\s\-Server\s\$_\s\}.{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all of the domain controllers for all domains in a forest","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","N/A","1","0","N/A","N/A","6","6","N/A","N/A","N/A","N/A","4077"
"*(msds-supportedencryptiontypes=0)(msds-supportedencryptiontypes:1.2.840.113556.1.4.803:=4)))*",".{0,1000}\(msds\-supportedencryptiontypes\=0\)\(msds\-supportedencryptiontypes\:1\.2\.840\.113556\.1\.4\.803\:\=4\)\)\).{0,1000}","greyware_tool_keyword","ldap queries","used by Rubeus and S4UTomato tools","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","N/A","1","0","N/A","N/A","10","10","N/A","N/A","N/A","N/A","4081"
"*(objectCategory=person)(objectClass=user)(serviceAccount=TRUE)*",".{0,1000}\(objectCategory\=person\)\(objectClass\=user\)\(serviceAccount\=TRUE\).{0,1000}","greyware_tool_keyword","ldap queries","Query to find service accounts which are typically high-privileged and targeted for privilege escalation","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/mthcht/ThreatHunting-Keywords","1","0","N/A","N/A","8","6","563","61","2025-03-03T15:48:41Z","2023-05-16T15:38:26Z","4085"
"*(objectclass=group)(samaccountname=domain admins)*",".{0,1000}\(objectclass\=group\)\(samaccountname\=domain\sadmins\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate Domain Admins","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4086"
"*(userAccountControl:1.2.840.113556.1.4.803:=524288)*",".{0,1000}\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=524288\).{0,1000}","greyware_tool_keyword","ldap queries","Accounts Trusted for Delegation","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://gist.github.com/jsecurity101/9c7e94f95b8d90f9252d64949562ba5d","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","4091"
"*[ADSI]* | Select-Object -Property *lockoutDuration*",".{0,1000}\[ADSI\].{0,1000}\s\|\sSelect\-Object\s\-Property\s.{0,1000}lockoutDuration.{0,1000}","greyware_tool_keyword","ldap queries","enumeration of Domain Password Policies","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13429"
"*[ADSI]* | Select-Object -Property *lockoutThreshold*",".{0,1000}\[ADSI\].{0,1000}\s\|\sSelect\-Object\s\-Property\s.{0,1000}lockoutThreshold.{0,1000}","greyware_tool_keyword","ldap queries","enumeration of Domain Password Policies","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13430"
"*[ADSI]* | Select-Object -Property *minPwdLength*",".{0,1000}\[ADSI\].{0,1000}\s\|\sSelect\-Object\s\-Property\s.{0,1000}minPwdLength.{0,1000}","greyware_tool_keyword","ldap queries","enumeration of Domain Password Policies","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13431"
"*[ADSI]*LDAP://CN=Domain Admins*| ForEach-Object {[adsi]""LDAP://$_""}; *.distinguishedname*",".{0,1000}\[ADSI\].{0,1000}LDAP\:\/\/CN\=Domain\sAdmins.{0,1000}\|\sForEach\-Object\s\{\[adsi\]\""LDAP\:\/\/\$_\""\}\;\s.{0,1000}\.distinguishedname.{0,1000}","greyware_tool_keyword","ldap queries","enumeration of Domain Admins group members","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13432"
"*[ADSI]*LDAP://dc=* | Select -Property pwdProperties*",".{0,1000}\[ADSI\].{0,1000}LDAP\:\/\/dc\=.{0,1000}\s\|\sSelect\s\-Property\spwdProperties.{0,1000}","greyware_tool_keyword","ldap queries","get LDAP properties for password settings directly","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13433"
"*[adsisearcher]""(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))""; $users = $searchUsers.FindAll(); $userProps = $users.Properties; $userProps | Where-Object {$_.description}*",".{0,1000}\[adsisearcher\]\""\(\&\(objectCategory\=person\)\(objectClass\=user\)\(!\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\)\""\;\s\$users\s\=\s\$searchUsers\.FindAll\(\)\;\s\$userProps\s\=\s\$users\.Properties\;\s\$userProps\s\|\sWhere\-Object\s\{\$_\.description\}.{0,1000}","greyware_tool_keyword","ldap queries","find user descriptions in Active Directory:","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13434"
"*[adsisearcher]""(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2))""*",".{0,1000}\[adsisearcher\]\""\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\"".{0,1000}","greyware_tool_keyword","ldap queries","find all disabled user accounts","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13435"
"*[adsisearcher]""(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=2560)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))""*",".{0,1000}\[adsisearcher\]\""\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2560\)\(!\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\)\"".{0,1000}","greyware_tool_keyword","ldap queries","get a count of all inter domain trust accounts","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13436"
"*[adsisearcher]""(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))*",".{0,1000}\[adsisearcher\]\""\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=32\)\(!\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\)\).{0,1000}","greyware_tool_keyword","ldap queries","Detection of all accounts with 'Password Not Required'","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13437"
"*[adsisearcher]'(&(objectCategory=computer)(primaryGroupID=516))').FindAll()*",".{0,1000}\[adsisearcher\]\'\(\&\(objectCategory\=computer\)\(primaryGroupID\=516\)\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all Domain Controllers","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://web.archive.org/web/20240109000256/https://cyberdom.blog/2024/01/07/defender-for-identity-hunting-for-ldap/","1","0","N/A","N/A","9","10","N/A","N/A","N/A","N/A","13438"
"*[adsisearcher]'(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=32))').FindAll()*",".{0,1000}\[adsisearcher\]\'\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=32\)\)\'\)\.FindAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Enumerate all accounts that do not require a password","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://jsecurity101.medium.com/uncovering-adversarial-ldap-tradecraft-658b2deca384","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","13439"
"*[adsisearcher]*(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=66048)(!(userAccountControl:1.2.840.113556.1.4.803:=2))*",".{0,1000}\[adsisearcher\].{0,1000}\(\&\(objectCategory\=person\)\(objectClass\=user\)\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=66048\)\(!\(userAccountControl\:1\.2\.840\.113556\.1\.4\.803\:\=2\)\).{0,1000}","greyware_tool_keyword","ldap queries","ADSI query to retrieve all active user accounts with non-expiring passwords","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13440"
"*[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers*",".{0,1000}\[System\.DirectoryServices\.ActiveDirectory\.Domain\]\:\:GetCurrentDomain\(\)\.DomainControllers.{0,1000}","greyware_tool_keyword","ldap queries","Discover all Domain Controller in the domain using ADSI","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://adsecurity.org/?p=299","1","0","N/A","N/A","6","10","N/A","N/A","N/A","N/A","13509"
"*[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest().GlobalCatalogs*",".{0,1000}\[System\.DirectoryServices\.ActiveDirectory\.Forest\]\:\:GetCurrentForest\(\)\.GlobalCatalogs.{0,1000}","greyware_tool_keyword","ldap queries","Discover all Global Catalogs in the forest using ADSI","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://adsecurity.org/?p=299","1","0","N/A","N/A","6","10","N/A","N/A","N/A","N/A","13510"
"*[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest().RootDomain.PDCRoleOwner.Name*",".{0,1000}\[System\.DirectoryServices\.ActiveDirectory\.Forest\]\:\:GetCurrentForest\(\)\.RootDomain\.PDCRoleOwner\.Name.{0,1000}","greyware_tool_keyword","ldap queries","query for the primary domain controller within the forest","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","13511"
"*get-ADComputer -filter { PrimaryGroupID -eq ""516"" } -properties PrimaryGroupID*",".{0,1000}get\-ADComputer\s\-filter\s\{\sPrimaryGroupID\s\-eq\s\""516\""\s\}\s\-properties\sPrimaryGroupID.{0,1000}","greyware_tool_keyword","ldap queries","cmdlets to get computer information about Domain Controllers","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://adsecurity.org/?p=299","1","0","N/A","N/A","6","10","N/A","N/A","N/A","N/A","45832"
"*Get-ADUser -filter * -Properties SamAccountName, PasswordNotRequired | where { $_.passwordnotrequired -eq ""true"" } | where {$_.enabled -eq ""true""}*",".{0,1000}Get\-ADUser\s\-filter\s.{0,1000}\s\-Properties\sSamAccountName,\sPasswordNotRequired\s\|\swhere\s\{\s\$_\.passwordnotrequired\s\-eq\s\""true\""\s\}\s\|\swhere\s\{\$_\.enabled\s\-eq\s\""true\""\}.{0,1000}","greyware_tool_keyword","ldap queries","identifying accounts with 'Password Not Required","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","45858"
"*Get-ADUser -properties * -filter {(lastlogondate -notlike ""*"" -OR lastlogondate -le $90days) -AND (passwordlastset -le $90days) -AND (enabled -eq $True) -and (PasswordNeverExpires -eq $false) -and (whencreated -le $90days)}*",".{0,1000}Get\-ADUser\s\-properties\s.{0,1000}\s\-filter\s\{\(lastlogondate\s\-notlike\s\"".{0,1000}\""\s\-OR\slastlogondate\s\-le\s\$90days\)\s\-AND\s\(passwordlastset\s\-le\s\$90days\)\s\-AND\s\(enabled\s\-eq\s\$True\)\s\-and\s\(PasswordNeverExpires\s\-eq\s\$false\)\s\-and\s\(whencreated\s\-le\s\$90days\)\}.{0,1000}","greyware_tool_keyword","ldap queries","querying accounts that have not been logged into for over 90 days","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://github.com/swarleysez/AD-common-queries","1","0","N/A","N/A","8","1","7","3","2020-05-24T03:23:09Z","2020-03-10T19:43:51Z","45861"
"*powershell*[adsisearcher]*(objectcategory=group)*findAll()*",".{0,1000}powershell.{0,1000}\[adsisearcher\].{0,1000}\(objectcategory\=group\).{0,1000}findAll\(\).{0,1000}","greyware_tool_keyword","ldap queries","Red Teams and adversaries may leverage [Adsisearcher] to enumerate domain groups for situational awareness and Active Directory Discovery","T1087 - T1087.002 - T1018 - T1069 - T1069.002 - T1069.003 - T1133 - T1139","TA0007 - TA0009","N/A","N/A","Discovery","https://research.splunk.com/endpoint/089c862f-5f83-49b5-b1c8-7e4ff66560c7/","1","0","N/A","N/A","8","10","N/A","N/A","N/A","N/A","55210"
